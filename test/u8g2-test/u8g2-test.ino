#include <U8g2lib.h>
#include "temp_logo.h"

#define SCREEN_HEIGHT 64
#define SCREEN_WIDTH 128
#define YELLOW_OFFSET 16
#define OLED_SDA 21
#define OLED_SCL 22
U8G2_SSD1306_128X64_NONAME_F_HW_I2C u8g2(/*R2: rotation 180*/U8G2_R0, /*reset*/U8X8_PIN_NONE, /* clock */ OLED_SCL, /* data */ OLED_SDA);

// ' icon_about', 16x16px
const unsigned char epd_bitmap__icon_about [] PROGMEM = {
  0x00, 0x00, 0x07, 0xc0, 0x08, 0x20, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x20, 0x08, 0x40, 
  0x04, 0x80, 0x00, 0x80, 0x00, 0x80, 0x00, 0x80, 0x00, 0x80, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00
};
// ' icon_change_units', 16x16px
const unsigned char epd_bitmap__icon_change_units [] PROGMEM = {
  0x00, 0x00, 0x00, 0x00, 0x1f, 0xe0, 0x20, 0x10, 0x40, 0x08, 0x40, 0x00, 0x40, 0x00, 0x40, 0x00, 
  0x40, 0x00, 0x40, 0x00, 0x40, 0x00, 0x40, 0x00, 0x40, 0x08, 0x20, 0x10, 0x1f, 0xe0, 0x00, 0x00
};
// ' icon_enable_remote', 16x16px
const unsigned char epd_bitmap__icon_enable_remote [] PROGMEM = {
  0x00, 0x00, 0x00, 0x00, 0x3f, 0xfe, 0x00, 0x02, 0x00, 0x02, 0x00, 0x02, 0x3f, 0xf2, 0x00, 0x12, 
  0x00, 0x12, 0x3f, 0x12, 0x01, 0x12, 0x01, 0x12, 0x39, 0x12, 0x09, 0x12, 0x09, 0x12, 0x00, 0x00
};
// ' icon_reset', 16x16px
const unsigned char epd_bitmap__icon_reset [] PROGMEM = {
  0x00, 0x00, 0x07, 0xc0, 0x08, 0x30, 0x10, 0x08, 0x20, 0x04, 0x40, 0x04, 0x40, 0x02, 0x40, 0x02, 
  0x40, 0x02, 0x20, 0x84, 0x30, 0x84, 0x10, 0x84, 0x1c, 0x88, 0x02, 0x90, 0x01, 0x80, 0x3f, 0x80
};
// ' icon_set_temp', 16x16px
const unsigned char epd_bitmap__icon_set_temp [] PROGMEM = {
  0x00, 0x00, 0x0e, 0x38, 0x11, 0x28, 0x11, 0x38, 0x19, 0x00, 0x11, 0x00, 0x19, 0x00, 0x11, 0x00, 
  0x19, 0x00, 0x11, 0x00, 0x28, 0x80, 0x48, 0x40, 0x7f, 0xc0, 0x7f, 0xc0, 0x3f, 0x80, 0x00, 0x00
};
// ' icon_sleep', 16x16px
const unsigned char epd_bitmap__icon_sleep [] PROGMEM = {
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3f, 0x00, 0x02, 0x00, 0x04, 0x70, 0x08, 0x20, 
  0x10, 0x46, 0x3f, 0x72, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

// Array of all bitmaps for convenience. (Total bytes used to store images in PROGMEM = 288)
const unsigned char* bitmap_icons[6] = {
  epd_bitmap__icon_about,
  epd_bitmap__icon_change_units,
  epd_bitmap__icon_enable_remote,
  epd_bitmap__icon_reset,
  epd_bitmap__icon_set_temp,
  epd_bitmap__icon_sleep
};
// ' item_sel_background', 125x21px
const unsigned char epd_bitmap__item_sel_background [] PROGMEM = {
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xe8, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 
  0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 
  0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xe8, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08
};
// ' scrollbar_background', 4x64px
const unsigned char epd_bitmap__scrollbar_background [] PROGMEM = {
  0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x20, 0x00, 
  0x00, 0x20, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x20, 0x00, 0x30, 0x30, 0x30, 0x30, 0x30, 
  0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x00, 0x20, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x20, 
  0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x20, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00
};

/*
 * Show splash screen when device first boots
 */
void showSplashScreen(){
  u8g2.setFont(u8g2_font_lucasarts_scumm_subtitle_o_tf);
  u8g2.setFontMode(1);
  u8g2.clearBuffer();
  u8g2.drawStr(0,15, "Silvaback");

  u8g2.sendBuffer();
}

const int NUM_ITEMS = 6;

char menu_items[NUM_ITEMS][20] = {
  {"About"},
  {"Change units"},
  {"Enable remote"},
  {"Reset"},
  {"Set temperature"},
  {"Sleep"}
};

int selected_item = 0; // which item in the menu is selected
int previous_item; // item before the selected one
int next_item; // item after the selected one

void setup() {
  
  Serial.begin(115200);
  u8g2.begin();

//  showSplashScreen();

}

void loop() {
  // calculate the menu items
  previous_item = selected_item - 1;
  if(previous_item < 0){
    previous_item = NUM_ITEMS - 1; // wrap to the last menu item
  } 

  next_item = selected_item + 1;
  if(next_item >= NUM_ITEMS){
    next_item = 0; // wrap to the first menu item
  }

  
  u8g2.firstPage();
  
  do {
    // selected item background
    u8g2.drawBitmap(0, 22, 128/8, 21, epd_bitmap__item_sel_background);

    // previous item
    //u8g2.setFont(u8g2_font_ncenB14_tr);
    u8g2.setFont(u8g2_font_7x14_tr);
    u8g2.drawBitmap(3, 2, 16/8, 16, bitmap_icons[previous_item]);
    u8g2.drawStr(24,15,menu_items[previous_item]);

    // selected item
    u8g2.setFont(u8g2_font_7x14_tr);
    u8g2.drawBitmap(3, 24, 16/8, 16, bitmap_icons[selected_item]);
    u8g2.drawStr(24,38,menu_items[selected_item]);

    // next item
    u8g2.setFont(u8g2_font_7x14_tr);
    u8g2.drawBitmap(3, 47, 16/8, 16, bitmap_icons[next_item]);
    u8g2.drawStr(24,59, menu_items[next_item]);
    
    // scrollbar
    u8g2.drawBitmap(124, 0, 4/8, 64, epd_bitmap__scrollbar_background);
    
  } while ( u8g2.nextPage() );

}
